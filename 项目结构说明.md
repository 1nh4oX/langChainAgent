# 📁 项目结构详细说明

> 智能股票分析 Agent 项目 - 完整目录结构解释

---

## 📂 根目录文件

### 配置文件

| 文件 | 作用 | 说明 |
|------|------|------|
| **`.env`** | 环境变量配置 | 存储 API 密钥、base URL、模型名称等敏感信息（**不提交到 Git**） |
| **`.env.example`** | 环境变量模板 | `.env` 的示例文件，展示需要配置哪些变量 |
| **`.gitignore`** | Git 忽略规则 | 指定哪些文件/文件夹不提交到 Git（如 `.env`、`venv/`、`__pycache__/`） |
| **`requirements.txt`** | Python 依赖列表 | 列出项目所需的所有 Python 包及其版本 |
| **`setup.py`** | 项目安装配置 | 用于将项目打包成 Python 包，支持 `pip install` 安装 |

### 主程序文件

| 文件 | 作用 | 说明 |
|------|------|------|
| **`app.py`** | 命令行入口 | 主程序入口，提供命令行交互界面 |
| **`run_ui_safe.py`** | UI 启动脚本 | 安全启动 Streamlit UI 的 Python 脚本（处理编码问题） |
| **`run_ui.sh`** | UI 启动脚本（Shell） | Shell 脚本，快速启动 Streamlit UI |

### 文档文件

| 文件 | 作用 | 说明 |
|------|------|------|
| **`README.md`** | 项目主文档 | 项目介绍、快速开始、使用示例、功能说明 |
| **`README_FIRST.md`** | 新手入门指南 | 面向新手的详细入门教程 |
| **`数据说明.md`** | 数据源说明 | 说明数据来源、支持范围（A股）、限制等 |
| **`CONTRIBUTING.md`** | 贡献指南 | 如何为项目做贡献、代码规范、提 PR 流程 |
| **`LICENSE`** | 许可证 | MIT 许可证文件 |
| **`DEPLOY_GUIDE.md`** | 部署指南 | 详细部署教程（Streamlit Cloud、本地部署等） |
| **`QUICK_DEPLOY.md`** | 快速部署 | 快速部署步骤（简化版） |

---

## 📁 文件夹详解

### 🔧 核心代码目录

#### **`src/`** - 源代码目录（核心）

这是项目的核心代码目录，包含所有业务逻辑。

```
src/
├── __init__.py          # Python 包初始化文件
├── agent/               # Agent 核心模块
│   ├── __init__.py
│   └── stock_agent.py   # StockAnalysisAgent 类（Agent 主逻辑）
├── tools/               # 工具模块（5个股票分析工具）
│   ├── __init__.py
│   └── stock_data.py    # 5个工具函数（历史行情、新闻、技术指标等）
├── config/              # 配置管理
│   ├── __init__.py
│   └── settings.py      # 配置加载、环境变量管理
└── utils/                # 工具函数
    ├── __init__.py
    ├── date_utils.py    # 日期处理工具（日期格式化、日期范围计算）
    └── file_utils.py    # 文件处理工具（读写 CSV、JSON、Excel）
```

**详细说明：**

- **`agent/stock_agent.py`**：核心 Agent 类
  - `StockAnalysisAgent` 类：初始化 LLM、绑定工具、构建 Prompt
  - `_run_loop()` 方法：ReAct 循环执行逻辑
  - 系统提示词定义

- **`tools/stock_data.py`**：5个股票分析工具
  - `get_stock_history()` - 获取历史行情
  - `get_stock_news()` - 获取新闻资讯
  - `get_stock_technical_indicators()` - 计算技术指标
  - `get_industry_comparison()` - 行业对比
  - `analyze_stock_comprehensive()` - 综合分析

- **`config/settings.py`**：配置管理
  - 加载 `.env` 文件
  - 读取 API 密钥、base URL、模型名称
  - 提供默认配置

- **`utils/`**：工具函数
  - `date_utils.py`：日期格式化、计算日期范围
  - `file_utils.py`：文件读写（CSV、JSON、Excel）

---

### 🎨 用户界面目录

#### **`ui/`** - Web UI 界面

```
ui/
├── README.md                      # UI 使用说明
└── streamlit_app_with_login.py    # Streamlit Web 应用（主文件）
```

**详细说明：**

- **`streamlit_app_with_login.py`**：Streamlit Web 应用
  - 侧边栏：API 配置（用户输入 API 密钥）
  - 主界面：查询输入、结果显示、历史记录
  - 支持用户自行配置 API，可公开部署

- **`README.md`**：UI 使用指南
  - 如何启动 UI
  - 功能介绍
  - 部署说明

---

### 📚 文档目录

#### **`docs/`** - 项目文档

```
docs/
├── API.md                # API 文档（函数接口说明）
├── CHANGELOG.md         # 更新日志（版本历史）
├── PROJECT_STRUCTURE.md # 项目结构说明
└── UI_GUIDE.md          # UI 使用指南
```

**详细说明：**

- **`API.md`**：完整的 API 文档
  - 所有函数、类的详细说明
  - 参数、返回值、使用示例

- **`CHANGELOG.md`**：版本更新历史
  - 记录每个版本的变更
  - 新功能、Bug 修复、性能优化

- **`PROJECT_STRUCTURE.md`**：项目结构说明
  - 目录结构详解
  - 模块职责说明

- **`UI_GUIDE.md`**：UI 使用指南
  - 界面功能介绍
  - 操作步骤

---

### 💡 示例代码目录

#### **`examples/`** - 示例代码

```
examples/
├── basic_usage.py        # 基础使用示例
└── add_custom_tool.py    # 添加自定义工具示例
```

**详细说明：**

- **`basic_usage.py`**：基础使用示例
  - 如何初始化 Agent
  - 如何运行查询
  - 如何处理结果

- **`add_custom_tool.py`**：添加自定义工具示例
  - 如何定义新工具
  - 如何添加到 Agent
  - 完整示例代码

---

### 🧪 测试目录

#### **`tests/`** - 测试代码

```
tests/
└── (测试文件)
```

**详细说明：**

- 存放单元测试、集成测试代码
- 使用 `pytest` 运行测试
- 确保代码质量和功能正确性

---

### 📊 数据目录

#### **`data/`** - 数据存储

```
data/
├── raw/          # 原始数据（从 API 获取的原始数据）
└── processed/    # 处理后的数据（清洗、转换后的数据）
```

**详细说明：**

- **`raw/`**：原始数据
  - 从 AkShare API 获取的原始数据
  - CSV、JSON 格式

- **`processed/`**：处理后的数据
  - 清洗后的数据
  - 可用于分析的数据

---

### 🔨 脚本目录

#### **`scripts/`** - 脚本工具

```
scripts/
└── collect_news.py    # 新闻采集脚本
```

**详细说明：**

- **`collect_news.py`**：新闻采集脚本
  - 批量下载股票新闻
  - 保存为 CSV、JSON、Excel 格式
  - 用于测试和数据分析

---

### 📝 汇报材料目录

#### **`汇报材料/`** - 汇报相关文件

```
汇报材料/
├── README.md                    # 汇报材料使用指南
├── PPT大纲.md                   # PPT 内容规划（7页）
├── 演讲稿.md                    # 完整演讲稿（逐字稿）
├── 演讲要点-快速记忆版.md      # 核心要点速记
└── PPT代码片段.md               # 可直接复制的代码
```

**详细说明：**

- 用于技术汇报的完整材料包
- PPT 大纲、演讲稿、代码片段
- 3-5 分钟技术汇报准备

---

### 🔧 其他目录

#### **`.github/`** - GitHub 配置

```
.github/
└── (GitHub Actions、Issue 模板等)
```

**详细说明：**

- GitHub Actions 工作流配置
- Issue 模板、PR 模板
- 自动化 CI/CD 配置

---

#### **`.streamlit/`** - Streamlit 配置

```
.streamlit/
└── config.toml    # Streamlit 配置文件
```

**详细说明：**

- Streamlit 应用配置
- 主题、布局、行为设置

---

#### **`venv/`** - Python 虚拟环境

```
venv/
├── bin/           # 可执行文件（Python、pip 等）
├── lib/           # Python 库（安装的包）
└── pyvenv.cfg     # 虚拟环境配置
```

**详细说明：**

- Python 虚拟环境
- 隔离项目依赖，避免版本冲突
- **不提交到 Git**（在 `.gitignore` 中）

---

## 🎯 项目结构总结

### 核心模块（必须理解）

1. **`src/agent/`** - Agent 核心逻辑
2. **`src/tools/`** - 工具实现（5个股票分析工具）
3. **`ui/`** - Web 界面

### 辅助模块（了解即可）

4. **`src/config/`** - 配置管理
5. **`src/utils/`** - 工具函数
6. **`docs/`** - 文档
7. **`examples/`** - 示例代码
8. **`scripts/`** - 脚本工具

### 开发相关

9. **`tests/`** - 测试代码
10. **`data/`** - 数据存储
11. **`.github/`** - GitHub 配置
12. **`.streamlit/`** - Streamlit 配置

### 环境相关

13. **`venv/`** - Python 虚拟环境（不提交）
14. **`.env`** - 环境变量（不提交）

---

## 📖 快速导航

### 想了解核心功能？

→ 看 `src/agent/stock_agent.py` 和 `src/tools/stock_data.py`

### 想运行项目？

→ 看 `README.md` 的"快速开始"部分

### 想使用 Web UI？

→ 看 `ui/streamlit_app_with_login.py` 或 `ui/README.md`

### 想添加新功能？

→ 看 `examples/add_custom_tool.py` 和 `CONTRIBUTING.md`

### 想部署项目？

→ 看 `DEPLOY_GUIDE.md` 或 `QUICK_DEPLOY.md`

### 想准备汇报？

→ 看 `汇报材料/README.md`

---

## 🔍 文件关系图

```
用户查询
    ↓
app.py (命令行) 或 ui/streamlit_app_with_login.py (Web UI)
    ↓
src/agent/stock_agent.py (Agent 核心)
    ↓
src/tools/stock_data.py (工具调用)
    ↓
AkShare API (数据获取)
    ↓
返回结果
```

---

**希望这个说明对你有帮助！** 🎉

