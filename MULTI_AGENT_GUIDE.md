# 多Agent交易分析系统 - 使用说明

## 快速开始

### 方式1: 命令行模式 (推荐首次使用)

```bash
# 1. 激活虚拟环境
source venv/bin/activate

# 2. 运行多Agent分析
python app_multi_agent.py

# 3. 输入股票代码
# 例如: 600519 (贵州茅台)

# 4. 查看分析结果
```

### 方式2: Web界面模式

```bash
# 1. 激活虚拟环境
source venv/bin/activate

# 2. 启动Streamlit服务
streamlit run ui/streamlit_app_multi_agent.py

# 3. 浏览器访问 http://localhost:8501
```

## 命令行参数

```bash
python app_multi_agent.py \
  --symbol 600519 \      # 股票代码(可选)
  --threshold 3.0 \      # 辩论阈值(默认3.0)
  --max-rounds 2 \       # 最大辩论轮次(默认2)
  --no-verbose           # 不显示详细过程
```

## 配置参数说明

### 辩论阈值 (debate_threshold)
- **作用**: 多空评分差异超过此值时触发辩论
- **范围**: 1.0 - 10.0
- **默认**: 3.0
- **建议**: 
  - 3.0: 平衡的辩论频率
  - 1.0-2.0: 更频繁的辩论
  - 5.0+: 仅在分歧巨大时辩论

### 最大辩论轮次 (max_debate_rounds)
- **作用**: 限制辩论轮次,节省API成本
- **范围**: 1 - 3
- **默认**: 2
- **建议**:
  - 2轮: 节省成本,适合测试
  - 3轮: 深度辩论,更全面分析

## 系统工作流程

```
1. 用户输入股票代码
   ↓
2. 数据分析师 - 获取并分析数据,评分
   ↓
3. 新闻研究员 - 搜索新闻并给建议
   ↓
4. 多头评审 - 从看涨角度评审
   |
   +-- 空头评审 - 从看跌角度评审
       ↓
5. 判断: 评分差异 >= 阈值?
   ├── 是 → 辩论协调员组织辩论
   └── 否 → 直接生成报告
       ↓
6. 输出最终分析报告
```

## API配置 (测试环境)

测试阶段已内置硅基流动API,无需额外配置。

如需使用自己的API:
1. 修改 `app_multi_agent.py` 中的 `api_key` 和 `base_url`
2. 或创建 `.env` 文件并配置

## 输出说明

### 最终报告包含

1. **最终建议**: 买入/持有/卖出
2. **信心水平**: 高/中/低
3. **关键评分**: 
   - 数据分析评分
   - 多头评审评分
   - 空头评审评分
   - 评分差异
4. **简要分析**: 投资理由和风险提示
5. **各Agent工作详情**: 可展开查看
6. **辩论过程** (如发生): 多轮辩论详情

### Web界面特色

- 🎨 现代化玻璃拟态设计
- 📊 关键指标卡片展示
- 🔄 Agent工作流时间线
- 💬 辩论过程可视化
- ⚙️ 参数实时配置

## 支持的股票

- ✅ **A股**: 沪深两市所有股票
  - 上海: 60XXXX
  - 深圳: 00XXXX, 30XXXX
- ❌ **不支持**: 港股、美股、其他市场

## 常见问题

### Q: 分析时间太长?
A: 完整分析需40-50秒,包含5个Agent的工作。可使用`--no-verbose`隐藏详细过程。

### Q: 如何触发辩论?
A: 设置更低的阈值(如1.0-2.0),或选择争议性较大的股票。

### Q: 可以连续分析多只股票吗?
A: 命令行模式下,分析完一只后可继续输入。Web界面会保留历史记录。

### Q: 评分是如何给出的?
A: Agent基于技术指标、新闻情绪、行业对比等多维度综合评分。

## 技术支持

- 项目目录: `/Users/haoyin/Documents/QT_formal/langChainAgent`
- 详细文档: 查看 `walkthrough.md`
- 实施计划: 查看 `implementation_plan.md`

## 注意事项

⚠️ **免责声明**: 
- 本系统仅供学习和研究
- 不构成任何投资建议
- 股市有风险,投资需谨慎

⚡ **性能提示**:
- 使用虚拟环境避免依赖冲突
- 网络状况影响数据获取速度
- API调用会消耗token配额
