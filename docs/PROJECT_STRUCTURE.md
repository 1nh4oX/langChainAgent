# é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ ç›®å½•ç»“æ„

```
stock-analysis-agent/
â”œâ”€â”€ .github/                  # GitHub é…ç½®
â”‚   â””â”€â”€ workflows/            # CI/CD å·¥ä½œæµï¼ˆé¢„ç•™ï¼‰
â”‚
â”œâ”€â”€ src/                      # æºä»£ç 
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent/                # Agent æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ stock_agent.py    # StockAnalysisAgent ç±»
â”‚   â”œâ”€â”€ tools/                # å·¥å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ stock_data.py     # è‚¡ç¥¨æ•°æ®å·¥å…·ï¼ˆ5ä¸ªå·¥å…·ï¼‰
â”‚   â”œâ”€â”€ config/               # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ settings.py       # Settings é…ç½®ç±»
â”‚   â””â”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ file_utils.py     # æ–‡ä»¶æ“ä½œï¼ˆCSV/JSONï¼‰
â”‚       â””â”€â”€ date_utils.py     # æ—¥æœŸå¤„ç†
â”‚
â”œâ”€â”€ scripts/                  # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ collect_news.py       # æ–°é—»é‡‡é›†è„šæœ¬
â”‚   â””â”€â”€ migrate_old_files.py  # æ–‡ä»¶è¿ç§»è„šæœ¬
â”‚
â”œâ”€â”€ tests/                    # æµ‹è¯•ä»£ç ï¼ˆé¢„ç•™ï¼‰
â”‚   â””â”€â”€ .gitkeep
â”‚
â”œâ”€â”€ data/                     # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ raw/                  # åŸå§‹æ•°æ®ï¼ˆCSV/JSONï¼‰
â”‚   â”‚   â””â”€â”€ .gitkeep
â”‚   â””â”€â”€ processed/            # å¤„ç†åæ•°æ®
â”‚       â””â”€â”€ .gitkeep
â”‚
â”œâ”€â”€ docs/                     # æ–‡æ¡£
â”‚   â”œâ”€â”€ API.md                # API æ–‡æ¡£
â”‚   â”œâ”€â”€ CHANGELOG.md          # æ›´æ–°æ—¥å¿—
â”‚   â””â”€â”€ PROJECT_STRUCTURE.md  # æœ¬æ–‡ä»¶
â”‚
â”œâ”€â”€ examples/                 # ç¤ºä¾‹ä»£ç 
â”‚   â”œâ”€â”€ .gitkeep
â”‚   â”œâ”€â”€ basic_usage.py        # åŸºç¡€ä½¿ç”¨ç¤ºä¾‹
â”‚   â””â”€â”€ add_custom_tool.py    # è‡ªå®šä¹‰å·¥å…·ç¤ºä¾‹
â”‚
â”œâ”€â”€ ui/                       # UI ç•Œé¢ï¼ˆé¢„ç•™ï¼‰
â”‚
â”œâ”€â”€ old_files/                # æ—§æ–‡ä»¶å¤‡ä»½ï¼ˆè¿ç§»åå¯åˆ é™¤ï¼‰
â”‚
â”œâ”€â”€ venv/                     # Python è™šæ‹Ÿç¯å¢ƒï¼ˆ.gitignoreï¼‰
â”‚
â”œâ”€â”€ app.py                    # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ setup.py                  # åŒ…å®‰è£…é…ç½®
â”œâ”€â”€ requirements.txt          # ä¾èµ–é…ç½®
â”œâ”€â”€ .env                      # ç¯å¢ƒé…ç½®ï¼ˆ.gitignoreï¼‰
â”œâ”€â”€ .env.example              # é…ç½®æ¨¡æ¿
â”œâ”€â”€ .gitignore                # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ LICENSE                   # MIT è®¸å¯è¯
â”œâ”€â”€ README.md                 # é¡¹ç›®è¯´æ˜ï¼ˆæ–°ç‰ˆï¼‰
â”œâ”€â”€ README_NEW.md             # é¡¹ç›®è¯´æ˜ï¼ˆå¤‡ä»½ï¼‰
â””â”€â”€ CONTRIBUTING.md           # è´¡çŒ®æŒ‡å—
```

## ğŸ“ æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### ä¸»ç¨‹åºå…¥å£

#### `app.py`
- **ä½œç”¨**: ä¸»ç¨‹åºå…¥å£ï¼Œæä¾›äº¤äº’å¼å‘½ä»¤è¡Œç•Œé¢
- **è¿è¡Œ**: `python app.py`
- **åŠŸèƒ½**: åˆå§‹åŒ– Agentï¼Œå¤„ç†ç”¨æˆ·è¾“å…¥ï¼Œæ˜¾ç¤ºåˆ†æç»“æœ

### æºä»£ç æ¨¡å—

#### `src/agent/stock_agent.py`
- **æ ¸å¿ƒç±»**: `StockAnalysisAgent`
- **åŠŸèƒ½**: 
  - Agent æ ¸å¿ƒé€»è¾‘
  - å·¥å…·è°ƒç”¨ç®¡ç†
  - é€’å½’æ¨ç†å®ç°
  - è‡ªå®šä¹‰å·¥å…·æ”¯æŒ
- **å…³é”®æ–¹æ³•**:
  - `__init__()`: åˆå§‹åŒ– Agent
  - `run(query)`: æ‰§è¡ŒæŸ¥è¯¢
  - `add_tool(tool)`: æ·»åŠ å·¥å…·

#### `src/tools/stock_data.py`
- **5ä¸ªå·¥å…·å‡½æ•°**:
  1. `get_stock_history`: å†å²è¡Œæƒ…
  2. `get_stock_news`: æ–°é—»èµ„è®¯
  3. `get_stock_technical_indicators`: æŠ€æœ¯æŒ‡æ ‡
  4. `get_industry_comparison`: è¡Œä¸šå¯¹æ¯”
  5. `analyze_stock_comprehensive`: ç»¼åˆåˆ†æ
- **æ•°æ®æº**: AkShare
- **è¿”å›æ ¼å¼**: Markdown æ–‡æœ¬

#### `src/config/settings.py`
- **é…ç½®ç±»**: `Settings`
- **åŠŸèƒ½**:
  - ä» `.env` åŠ è½½é…ç½®
  - å•ä¾‹æ¨¡å¼ç®¡ç†å…¨å±€é…ç½®
  - ç±»å‹å®‰å…¨çš„é…ç½®è®¿é—®
- **é…ç½®é¡¹**:
  - API å¯†é’¥å’ŒURL
  - æ¨¡å‹å‚æ•°
  - ç³»ç»Ÿè®¾ç½®

#### `src/utils/`
- **file_utils.py**: æ–‡ä»¶æ“ä½œï¼ˆä¿å­˜/åŠ è½½ CSVã€JSONï¼‰
- **date_utils.py**: æ—¥æœŸå¤„ç†ï¼ˆæ ¼å¼è½¬æ¢ã€èŒƒå›´è®¡ç®—ï¼‰

### è„šæœ¬å·¥å…·

#### `scripts/collect_news.py`
- **åŠŸèƒ½**: é‡‡é›†100æ¡Aè‚¡æ–°é—»æ•°æ®
- **è¾“å‡º**: CSVã€JSONã€Excelã€ç»Ÿè®¡æŠ¥å‘Š
- **è¿è¡Œ**: `python scripts/collect_news.py`

#### `scripts/migrate_old_files.py`
- **åŠŸèƒ½**: è¿ç§»æ—§é¡¹ç›®æ–‡ä»¶åˆ°æ–°ç»“æ„
- **è¿è¡Œ**: `python scripts/migrate_old_files.py`
- **å®‰å…¨**: å¤‡ä»½åŸæ–‡ä»¶ï¼Œä¸ä¼šä¸¢å¤±æ•°æ®

### ç¤ºä¾‹ä»£ç 

#### `examples/basic_usage.py`
- 6ä¸ªä½¿ç”¨ç¤ºä¾‹
- æ¶µç›–åŸºç¡€åˆ°é«˜çº§ç”¨æ³•
- è¿è¡Œ: `python examples/basic_usage.py`

#### `examples/add_custom_tool.py`
- æ¼”ç¤ºå¦‚ä½•æ·»åŠ è‡ªå®šä¹‰å·¥å…·
- åŒ…å«å®Œæ•´ç¤ºä¾‹å·¥å…·
- è¿è¡Œ: `python examples/add_custom_tool.py`

### é…ç½®æ–‡ä»¶

#### `.env`
- å®é™…é…ç½®æ–‡ä»¶ï¼ˆä¸æäº¤åˆ° Gitï¼‰
- åŒ…å« API å¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯
- ä» `.env.example` å¤åˆ¶åˆ›å»º

#### `.env.example`
- é…ç½®æ¨¡æ¿
- æä¾›å¤šä¸ªå…è´¹ API æ–¹æ¡ˆ
- æäº¤åˆ° Git ä¾›å‚è€ƒ

#### `requirements.txt`
- Python ä¾èµ–åŒ…åˆ—è¡¨
- å®‰è£…: `pip install -r requirements.txt`

#### `setup.py`
- åŒ…å®‰è£…é…ç½®
- æ”¯æŒ: `pip install -e .`

### æ–‡æ¡£

#### `README.md`
- é¡¹ç›®ä¸»æ–‡æ¡£
- å¿«é€Ÿå¼€å§‹æŒ‡å—
- åŠŸèƒ½è¯´æ˜
- ä½¿ç”¨ç¤ºä¾‹

#### `CONTRIBUTING.md`
- è´¡çŒ®æŒ‡å—
- å¼€å‘æµç¨‹
- ä»£ç è§„èŒƒ
- åŠŸèƒ½å»ºè®®

#### `docs/API.md`
- å®Œæ•´çš„ API æ–‡æ¡£
- æ‰€æœ‰ç±»å’Œå‡½æ•°è¯´æ˜
- å‚æ•°å’Œè¿”å›å€¼
- ä½¿ç”¨ç¤ºä¾‹

#### `docs/CHANGELOG.md`
- ç‰ˆæœ¬æ›´æ–°å†å²
- æ–°å¢åŠŸèƒ½è®°å½•
- Bug ä¿®å¤è®°å½•

## ğŸ”§ å¼€å‘å·¥ä½œæµ

### 1. æ·»åŠ æ–°åŠŸèƒ½

```bash
# 1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/new-tool

# 2. åœ¨ src/tools/ æ·»åŠ å·¥å…·
# ç¼–è¾‘ src/tools/stock_data.py æˆ–åˆ›å»ºæ–°æ–‡ä»¶

# 3. åœ¨ src/tools/__init__.py å¯¼å‡º
# 4. ç¼–å†™æµ‹è¯• tests/test_new_tool.py
# 5. æ›´æ–°æ–‡æ¡£ docs/API.md
# 6. æäº¤ä»£ç 
git add .
git commit -m "feat: add new analysis tool"
git push origin feature/new-tool
```

### 2. ä¿®å¤ Bug

```bash
# 1. åˆ›å»ºä¿®å¤åˆ†æ”¯
git checkout -b fix/bug-description

# 2. ä¿®æ”¹ä»£ç 
# 3. æ·»åŠ æµ‹è¯•éªŒè¯ä¿®å¤
# 4. æäº¤
git commit -m "fix: resolve issue with..."
```

### 3. æ›´æ–°æ–‡æ¡£

```bash
# 1. ç¼–è¾‘ docs/ æˆ– README.md
# 2. æäº¤
git commit -m "docs: update API documentation"
```

## ğŸ“¦ æ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥
   â†“
app.py
   â†“
StockAnalysisAgent
   â†“
LLM æ¨ç† â†’ é€‰æ‹©å·¥å…·
   â†“
Tools (src/tools/)
   â†“
AkShare API
   â†“
æ•°æ®è¿”å› â†’ LLM åˆ†æ
   â†“
è¾“å‡ºç»“æœ
```

## ğŸ¯ æ¨¡å—èŒè´£

| æ¨¡å— | èŒè´£ | ä¾èµ– |
|------|------|------|
| `app.py` | ç”¨æˆ·äº¤äº’ | `src.agent` |
| `src.agent` | Agent æ ¸å¿ƒé€»è¾‘ | `src.tools`, `langchain` |
| `src.tools` | æ•°æ®è·å–å’Œåˆ†æ | `akshare`, `pandas` |
| `src.config` | é…ç½®ç®¡ç† | `python-dotenv` |
| `src.utils` | è¾…åŠ©å‡½æ•° | `pandas` |
| `scripts/` | ç‹¬ç«‹è„šæœ¬ | `src.utils`, `akshare` |
| `examples/` | ç¤ºä¾‹ä»£ç  | `src.*` |

## ğŸš€ æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°çš„æ•°æ®æº

1. åœ¨ `src/tools/` åˆ›å»ºæ–°æ–‡ä»¶ï¼ˆå¦‚ `financial_data.py`ï¼‰
2. å®ç°å·¥å…·å‡½æ•°
3. åœ¨ `__init__.py` å¯¼å‡º
4. åœ¨ Agent ä¸­æ³¨å†Œ

### å¼€å‘ Web UI

1. åœ¨ `ui/` ç›®å½•åˆ›å»º UI ä»£ç 
2. æ¨èä½¿ç”¨ Streamlit æˆ– Gradio
3. å¯¼å…¥ `src.agent.StockAnalysisAgent`
4. åˆ›å»ºäº¤äº’ç•Œé¢

### æ·»åŠ æµ‹è¯•

1. åœ¨ `tests/` åˆ›å»ºæµ‹è¯•æ–‡ä»¶
2. ä½¿ç”¨ pytest æ¡†æ¶
3. å‘½åè§„èŒƒ: `test_*.py`
4. è¿è¡Œ: `pytest tests/`

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

- **æ€»ä»£ç è¡Œæ•°**: ~1000+ è¡Œ
- **æ ¸å¿ƒæ¨¡å—**: 4 ä¸ª
- **å·¥å…·æ•°é‡**: 5 ä¸ªï¼ˆå¯æ‰©å±•ï¼‰
- **ç¤ºä¾‹æ•°é‡**: 2 ä¸ªæ–‡ä»¶ï¼Œ10+ ç¤ºä¾‹
- **æ–‡æ¡£æ–‡ä»¶**: 5 ä¸ª

## ğŸ”„ ç‰ˆæœ¬æ§åˆ¶

### Git åˆ†æ”¯ç­–ç•¥

- `main`: ç¨³å®šç‰ˆæœ¬
- `develop`: å¼€å‘ç‰ˆæœ¬
- `feature/*`: æ–°åŠŸèƒ½åˆ†æ”¯
- `fix/*`: Bug ä¿®å¤åˆ†æ”¯
- `docs/*`: æ–‡æ¡£æ›´æ–°åˆ†æ”¯

### æäº¤è§„èŒƒ

éµå¾ª [Conventional Commits](https://www.conventionalcommits.org/)ï¼š

- `feat:` æ–°åŠŸèƒ½
- `fix:` Bug ä¿®å¤
- `docs:` æ–‡æ¡£
- `style:` ä»£ç æ ¼å¼
- `refactor:` é‡æ„
- `test:` æµ‹è¯•
- `chore:` æ„å»º/å·¥å…·

## ğŸ’¡ æœ€ä½³å®è·µ

1. **æ¨¡å—åŒ–**: ä¿æŒæ¨¡å—èŒè´£å•ä¸€
2. **æ–‡æ¡£åŒ–**: æ‰€æœ‰å‡½æ•°æ·»åŠ  docstring
3. **ç±»å‹æç¤º**: ä½¿ç”¨ Python ç±»å‹æ³¨è§£
4. **é”™è¯¯å¤„ç†**: æ•è·å¹¶è¿”å›å‹å¥½é”™è¯¯ä¿¡æ¯
5. **æµ‹è¯•**: ä¸ºæ–°åŠŸèƒ½ç¼–å†™æµ‹è¯•
6. **ç‰ˆæœ¬æ§åˆ¶**: éµå¾ª Git å·¥ä½œæµ
7. **ä»£ç å®¡æŸ¥**: PR å‰è‡ªæŸ¥ä»£ç è´¨é‡

---

æœ€åæ›´æ–°: 2025-12-03




